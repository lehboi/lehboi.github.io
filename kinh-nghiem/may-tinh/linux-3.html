<!doctype html>
<html amp lang="vi">
<head>
<title>Linux (3)</title>
<meta name="description" content="Trang 3: Một vài kinh nghiệm dùng máy Linux: kernel, RAID, LVM, file system" />
<meta name="keywords" content="hữu ích, tài chính, cá nhân">
<link rel="canonical" href="https://lehboi.github.io/kinh-nghiem/may-tinh/linux-3">
<link rel="alternate" href="https://www.lhboi.name.vn/kinh-nghiem/may-tinh/linux-3">

<!-- in head of html file -->
<meta charset='utf-8'>

<script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>

<script async src="https://cdn.ampproject.org/v0.js"></script>
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>


<script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>

<script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script>

<script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script>

<script async custom-element="amp-facebook-like" src="https://cdn.ampproject.org/v0/amp-facebook-like-0.1.js"></script>
<script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>

<!-- font-size https://css-tricks.com/snippets/css/fluid-typography/ -->
<style amp-custom>
html {
  font-size: 17px;
}
@media screen and (min-width: 320px) {
  html {
    font-size: calc(17px + 7 * ((100vmin - 320px) / 680));
  }
}
@media screen and (min-width: 1000px) {
  html {
    font-size: 24px;
  }
}

amp-sidebar {
  width: 240px;
  padding-right: 2px;
  background: darkblue;
  color: blue;
  font-size: 100%;
  font-family: sans-serif;
}
.close-sidebar{width: 30px;height: 30px;position: relative;cursor: pointer;background-color: transparent;border: none;}
.close-sidebar:focus{outline: 2px auto #f06060;}
.close-sidebar span{position: absolute;left: 0;width: 30px;height: 2px;border-right: 5px;background-color: #004d00;}
.close-sidebar span:nth-child(1){transform: rotate(45deg);}
.close-sidebar span:nth-child(2){transform: rotate(-45deg);}

div.mwidth {max-width:1004px;margin: auto;}

body {background-color:dimgray;}
div.body {max-width:1004px;margin: auto; padding-left:8px; padding-right:8px; text-align:justify;color:white;background-color:black;font-family:sans-serif}
div.title {text-align:center;font-size:160%;font-weight:bold;color:#ffe033;font-family:serif}
div.right {text-align:right;}
div.lrsp {margin: 0px 5px 0px 5px;}
.todiscuss {color:lightskyblue;}
div.center {text-align:center;}
div.inlineleft { display:inline;float:left;margin:0px 5px 0px 0px; }
h1 {text-align:center;color:#ffe033;font-family:serif}
h2 {color:#adff33;font-family:serif}
h3 {color:#a3ff1a;font-family:serif}
h4 {color:#8ae600;font-family:serif}
a {color:#ffd700;}
a:visited {color:#e6c300;}
.flright { float:right; margin:0px 0px 0px 5px; width:45%; }

table.noborder {
  border-collapse: collapse;
  width: 100%;
  border: 0px;
  text-align: left;
  padding: 4px;
}

.myheader {
    background-color:darkblue; 
}

th, td {
  text-align: left;
  padding: 2px;
  vertical-align: top;
}
tr:nth-child(even){background-color: darkslategray}
table.withborder {
  width: 100%;
  border: 2px;
  border-color: #111111;
  text-align: left;
  padding: 4px;
}
.fbold { font-weight:bold; }
.tmark {background-color:navy;}

div.even {background-color: darkslategray}
.red {color:red;}
.tblue {color:deepskyblue;}
div.footer { font-size: 80%; color: red; text-align: center; }

@media (max-width: 399px) {
  .mbutton { display:inline;float:left;padding-top:7px;padding-right:10px; }

  .leftads {position:absolute;top:0;left:0;height:600px;width:0px;margin:0;align:right;}
  .rightads {position:absolute;top:0;right:0;height:600px;width:0px;margin:0;}

}
@media (min-width: 400px) and (max-width: 499px) {
  .mbutton { display:inline;float:left;padding-top:7px;padding-right:20px; }

  .leftads {position:absolute;top:0;left:0;height:600px;width:0px;margin:0;align:right;}
  .rightads {position:absolute;top:0;right:0;height:600px;width:0px;margin:0;}

}
@media (min-width: 500px) {
  .mbutton { display:inline;float:left;padding-top:7px;padding-right:40px; }

  .leftads {position:absolute;top:0;left:0;height:600px;width:0px;margin:0;align:right;}
  .rightads {position:absolute;top:0;right:0;height:600px;width:0px;margin:0;}

}
@media (min-width: 1260px) {
  .mbutton { display:inline;float:left;padding-top:7px;padding-right:40px; }

  .leftads {position:absolute;top:0;left:0;height:100vh;width: calc((100% - 1020px)/2);margin:0;align:right;}
  .rightads {position:absolute;top:0;right:0;height:100vh;width: calc((100% - 1020px)/2);margin:0;}

}

</style>
</head>


<body>
  <!-- top of body -->
  <!-- sidebar menu -->
  <amp-sidebar id="sidebar" layout="nodisplay" side="left">
            <button on="tap:sidebar.close" class="close-sidebar">
                <span></span>
                <span></span>
            </button>
  <h3 class="myheader"><a href='/'>Giới-thiệu</a></h3>
    <a href='/home/about'>Thân-thế</a><br>
    <a href='/home/cv'>Thành-tích</a><br>
  <h3 class="myheader"><a href='/huu-ich/'>Hữu-ích</a></h3>

      <h4 class="myheader"><a href='/huu-ich/ke-hoach-tai-chinh/'>Lập-kế-hoạch-tài-chính</a></h4>

      <h4 class="myheader"><a href='/huu-ich/dau-tu-co-phieu/'>Đầu-tư-cổ-phiếu</a></h4>

      <h4 class="myheader"><a href='/huu-ich/cac-loai-bao-hiem/'>Các loại bảo-hiểm</a></h4>

      <h4 class="myheader"><a href='/huu-ich/cau-chuyen/'>Câu-chuyện</a></h4>

  <h3 class="myheader">Kinh-nghiệm</h3>
    <h4 class="myheader"><a href='/kinh-nghiem/may-tinh/'>Máy-tính</a></h4>

    <h4 class="myheader"><a href='/kinh-nghiem/chu-viet/'>Chữ-Việt</a></h4>

    <h4 class="myheader"><a href='/kinh-nghiem/linh-tinh/'>Linh tinh</a></h4>

  <h3 class="myheader"><a href='/y-kien/'>Ý kiến</a></h3>

  <h3 class="myheader">Danh mục</h3>
    <a href='/download/'>Download</a><br>
    <a href='/sitemap'>Mục lục</a>
  <h3 class="myheader"></h3>
  <br>
  <br>
  <br>
  <br>

  </amp-sidebar>
<main>
  <div class="mwidth">
    <div class="mbutton">
      <button on="tap:sidebar.toggle" class="ampstart-btn caps ml1" style="font-size:90%;font-weight:bold;background-color: blue; color: white;">MENU
      </button>
    </div>
  </div>
  
  <div class="leftads">
  <!-- AMP Responsive Skyscrapper -->
<amp-ad
media="(min-width: 1260px)"
layout="fill"
type="adsense"
data-ad-client="ca-pub-2242556057278004"
data-ad-slot="5275186684">
</amp-ad>

  </div>
  <div class="rightads">
  <!-- AMP Responsive Skyscrapper -->
<amp-ad
media="(min-width: 1260px)"
layout="fill"
type="adsense"
data-ad-client="ca-pub-2242556057278004"
data-ad-slot="5275186684">
</amp-ad>

  </div>
  

  <div class="body">
  <div>
    <amp-social-share type="email" height="32"></amp-social-share>
    <amp-social-share type="whatsapp" height="32"></amp-social-share>
    <amp-social-share type="linkedin" height="32"></amp-social-share>
    <amp-social-share type="twitter" height="32"></amp-social-share>
    <amp-social-share type="tumblr" height="32"></amp-social-share>
    <amp-social-share type="line" height="32"></amp-social-share>
    <amp-social-share type="facebook" height="32" data-param-app_id="1879212745697311"></amp-social-share>
    <amp-facebook-like height=32 width=90
      layout="fixed"
      data-layout="button_count"
      data-href=
https://lehboi.github.io/kinh-nghiem/may-tinh/linux
    >
    </amp-facebook-like>
  </div>

  <h1>Linux (3)</h1>
<h2>Tăng kích thước file system trong logical volume</h2>
<p>Dùng Logical Volume (LVM) để chứa file system rất tiện ở chỗ là có thể tăng kích thước khi file system bị hết chỗ. Nếu các đĩa cứng đang dùng còn dư chỗ chưa dùng đến thì cho nó vào volume group rồi cho logical volume đang đầy nở đến chỗ đó. Nếu các đĩa cứng đang dùng đã hết chỗ thì mua thêm ổ cứng mới gắn vào volume group.</p>
<p>Để tăng kích thước thì làm các lệnh sau:</p>
<ol><li>umount file system</li>
<li>lvresize -L +size{MG} LogicalVolumePath</li>
<li>fsck device</li>
<li>resize2fs device</li>
<li>mount file system</li>
</ol>
<p>Do phải umount file system nên không thể dùng cách này để tăng kích thước các file system cần thiết khi máy đang chạy là /usr, /var và nhất là /. Khi các file system này bị chật và không thể tăng kích thước thì ta có thể tạo một file system mới và dời bớt một directory nào đó từ file system bị chật sang file system mới.</p>
<p>Lệnh resize2fs có thể dùng cho cả file system loại ext3.</p>
<p>Logical Volume là một phần của một hay nhiều Physical Volume. Physical Volume được tạo từ một hay nhiều partition hay RAID. Vậy khi có từ 2 đĩa cứng giống nhau trở lên thì có thể kết hợp vừa RAID vừa LVM để tạo các file system một cách linh động và có tốc độ cao. Khi mới cài đặt thì chỉ tạo các file system là các logical volume với kích thước vừa đủ dùng, để lại một khoảng trống chưa dùng trong physical volume. Khi các file system bắt đầu chật mới tăng kích thước lên cho đủ.</p>
<p>File system nằm trực tiếp trên partition (không phải logical volume) cũng có thể tăng kích thước nếu đĩa cứng còn trống ngay sát sau partition đó.</p>
<p>Lệnh resize2fs cũng có thể giảm kích thước file system trước khi giảm kích thước của partition hay logical volume.</p>
<!-- AMP In-article 1 -->
<amp-ad
media="(max-width: 399px)"
height=280
layout="fixed-height"
type="adsense"
data-ad-client="ca-pub-2242556057278004"
data-ad-slot="3830899615">
</amp-ad>
<amp-ad
media="(min-width: 400px) and (max-width: 499px)"
height=250
layout="fixed-height"
type="adsense"
data-ad-client="ca-pub-2242556057278004"
data-ad-slot="3830899615">
</amp-ad>
<amp-ad
media="(min-width: 500px)"
height=100
layout="fixed-height"
type="adsense"
data-ad-client="ca-pub-2242556057278004"
data-ad-slot="3830899615">
</amp-ad>

<h2>Tạo các file định tính địa phương trong Linux</h2>
<p>Trong Linux, biến môi trường LANG dùng để thay đổi các tính chất địa phương (kiểu ngày tháng, tên tháng, ký hiệu tiền, thứ tự từ điển…) của môi trường làm việc. Để chọn địa phương Việt nam thì ta đặt LANG=vi_VN.UTF-8.<br />
Nếu cần thì ta còn phải dịch lại các file mô tả tính chất địa phương. Làm như sau trên Fedora Core 2:</p>
<pre>cd /usr/share/i18n/locales/
localedef --verbose --force -f UTF-8 -i vi_VN vi_VN.UTF-8</pre>
<p>Các file trong /usr/lib/locale/vi_VN không bị thay đổi. Không rõ output vào đâu nhưng những thay đổi có tác dụng!</p>
<h2>Configure kernel để dùng IDE ATA nhanh nhất</h2>
<p>Phải xem tài liệu kèm theo mainboard để biết nó dùng PCI IDE chipset nào và config kernel cho đúng. Luôn luôn chọn configuration parameter CONFIG_BLK_DEV_IDEPCI=y và CONFIG_IDEDMA_PCI_AUTO=y.</p>
<p>Với mainboard dùng chip Intel PIIX, thì chọn CONFIG_BLK_DEV_PIIX=y. Với ổ cứng Maxtor ATA-100, thì <tt>hdparm -t /dev/hda</tt> sẽ cho buffered disk read lên đến 34MB/s. Đáng lẽ ATA-100 thì phải được 100MB/sec. Nếu không dùng configuration đúng thì buffered disk read sẽ nhỏ hơn 5MB/s.</p>
<h2>Sửa udev rule để các device node có access mode cần thiết</h2>
<p>Sửa MODE trong các file trong /etc/udev/rules.d</p>
<div class="center">sang trang <a href="linux">1</a> - <a href="linux-2">2</a> - 3</div>

<!-- AMP In-article 1 -->
<amp-ad
media="(max-width: 399px)"
height=280
layout="fixed-height"
type="adsense"
data-ad-client="ca-pub-2242556057278004"
data-ad-slot="3830899615">
</amp-ad>
<amp-ad
media="(min-width: 400px) and (max-width: 499px)"
height=250
layout="fixed-height"
type="adsense"
data-ad-client="ca-pub-2242556057278004"
data-ad-slot="3830899615">
</amp-ad>
<amp-ad
media="(min-width: 500px)"
height=100
layout="fixed-height"
type="adsense"
data-ad-client="ca-pub-2242556057278004"
data-ad-slot="3830899615">
</amp-ad>

  <hr>
Hit count <amp-iframe width="120" height="30" frameborder="0" 
srcdoc="<img width='100' height='24' src='https://c.statcounter.com/12598906/0/9a8e736a/0/'>">
</amp-iframe> by <a href="https://statcounter.com" target='_blank'>statcounter.com</a>.
  <div class="footer">
  Bấm các nút sau để liên-lạc 
  <br>
  <a href="http://twitter.com/GiauCham" target="_blank"><amp-img src="/images/icons/Twitter-256.png" layout="fixed" width="40" height="40" alt="Twiter"></amp-img></a> 
  <a href="http://m.me/lamgiauchacchan" target="_blank"><amp-img src="/images/icons/Fb-Messenger-128.png" layout="fixed" width="40" height="40" alt="Facebook"></amp-img></a> 
  <a href="viber://add?number=84989760570"><amp-img src="/images/icons/Viber-128.png" layout="fixed" width="40" height="40" alt="Viber"></amp-img></a>
  <a href="http://zaloapp.com/qr/p/lzfbyqlwzn9u"><amp-img src="/images/icons/Zalo.webp" layout="fixed" width="40" height="40" alt="Zalo"></amp-img></a> 
  <a href="tel:+84989760570"><amp-img src="/images/icons/Cell-Phone-256.png" layout="fixed" width="40" height="40" alt="điện thoại"></amp-img></a>
  <a href="mailto:LEHBOI@GMAIL.COM?subject=www.lhboi.name.vn"><amp-img src="/images/icons/address_blue-128.png" layout="fixed" width="40" height="40" alt="email"></amp-img></a> 
  <a href="https://www.google.com/maps/place/L%C3%AA+H%E1%BB%93ng+B%E1%BB%99i/@10.720385,106.7007479,15z/data=!4m5!3m4!1s0x0:0x5e907d2164963e6f!8m2!3d10.720385!4d106.7007479" target='_blank'><amp-img src="/images/icons/Home_256x256.png" layout="fixed" width="40" height="40" alt="nhà"></amp-img></a>
  <br>
  Nếu bạn chép lại những trang-web này, hãy ghi nguồn-gốc <a href="https://lehboi.github.io">http://LeHBoi.github.io</a> để người-đọc có-thể tìm được nội-dung mới nhất.
  </div>
</div>
<amp-analytics type="googleanalytics">
  <script type="application/json">
  {
  "vars": { "account": "UA-25268996-1" },
  "triggers": {
  "trackPageview": {
  "on": "visible",
  "request": "pageview"
    }
   }
  }
  </script>
</amp-analytics>

</main>
</body>
</html>

